Description: Set as hopeful some networking tests.
 - Set as hopeFul some tests that inevitably fail
   if networking is disabled.
Author: Eric Heintzmann <heintzmann.eric@free.fr>
Last-Update: 2016-05-25
---

--- gnustep-base.orig/Tests/base/NSStream/socket.m
+++ gnustep-base/Tests/base/NSStream/socket.m
@@ -137,7 +137,9 @@
 
   // I cannot verify the content at www.google.com,
   // so as long as it has something, that is PASSing
+  testHopeful = YES;
   PASS(byteCount>0, "read www.google.com");
+  testHopeful = NO;
   [defaultInput setDelegate: nil];
   [defaultOutput setDelegate: nil];
 #endif
@@ -170,7 +172,9 @@
 	[rl runMode: NSDefaultRunLoopMode beforeDate: d];
       }
 
+    testHopeful = YES;
     PASS(byteCount>0, "read www.google.com https");
+    testHopeful = NO;
     [defaultInput setDelegate: nil];
     [defaultOutput setDelegate: nil];
   END_SET("NSStream SSL")
--- gnustep-base.orig/Tests/base/NSURL/basic.m
+++ gnustep-base/Tests/base/NSURL/basic.m
@@ -44,11 +44,15 @@
 
   url = [NSURL URLWithString: @"http://www.w3.org/"];
   data = [url resourceDataUsingCache: NO];
+  testHopeful = YES;
   PASS(data != nil,
     "Can load a page from www.w3.org");
+  testHopeful = NO;
   num = [url propertyForKey: NSHTTPPropertyStatusCodeKey];
+  testHopeful = YES;
   PASS([num isKindOfClass: [NSNumber class]] && [num intValue] == 200,
     "Status of load is 200 for www.w3.org");
+  testHopeful = NO;
 
   url = [NSURL URLWithString:@"this isn't a URL"];
   PASS(url == nil, "URL with 'this isn't a URL' returns nil");
@@ -56,8 +60,10 @@
   url = [NSURL URLWithString: @"http://www.w3.org/silly-file-name"];
   data = [url resourceDataUsingCache: NO];
   num = [url propertyForKey: NSHTTPPropertyStatusCodeKey];
+  testHopeful = YES;
   PASS([num isKindOfClass: [NSNumber class]] && [num intValue] == 404,
     "Status of load is 404 for www.w3.org/silly-file-name");
+  testHopeful = NO;
   str = [url scheme];
   PASS([str isEqual: @"http"],
        "Scheme of http://www.w3.org/silly-file-name is http");
--- gnustep-base.orig/Tests/base/NSURLConnection/basic.m
+++ gnustep-base/Tests/base/NSURLConnection/basic.m
@@ -35,10 +35,12 @@
   data = [NSURLConnection sendSynchronousRequest: mutable
                                returningResponse: &response
                                            error: &error];
+  testHopeful = YES;
   PASS(data != nil && [data length] > 0,
     "NSURLConnection synchronously load data from an http URL");
   PASS(response != nil && [(NSHTTPURLResponse*)response statusCode] > 0,
     "NSURLConnection synchronous load returns a response");
+  testHopeful = NO;
 
   path = [[NSFileManager defaultManager] currentDirectoryPath];
   path = [path stringByAppendingPathComponent: @"basic.m"];
@@ -57,8 +59,10 @@
                                returningResponse: &response
                                            error: &error];
 
+  testHopeful = YES;
   PASS(nil == error, "https://www.google.com/ does not return an error")
   PASS(nil != data, "https://www.google.com/ returns data")
+  testHopeful = NO;
 
   [arp release]; arp = nil;
   return 0;
--- gnustep-base.orig/Tests/base/NSURLHandle/test00.m
+++ gnustep-base/Tests/base/NSURLHandle/test00.m
@@ -117,8 +117,10 @@
    * background and wait a bit
    */
   [handle loadInBackground];
+  testHopeful = YES;
   PASS([self status] == URLHandleClientDidBeginLoading,
     "URLHandleResourceDidBeginLoading called");
+  testHopeful = NO;
 
   [handle release];
   return 0;
--- gnustep-base.orig/Tests/base/GSXML/basic.m
+++ gnustep-base/Tests/base/GSXML/basic.m
@@ -173,6 +173,7 @@
   PASS([str rangeOfString: @"MAKEFILES"].length > 0,
     "external entity is resolved")
 
+  testHopeful = YES;
   str = @"<!DOCTYPE plist PUBLIC \"-//GNUstep//DTD plist 0.9//EN\""
     @" \"http://www.gnustep.org/plist-0_9.xml\">\n"
     @"<plist></plist>";
@@ -192,6 +193,7 @@
   [parser resolveEntities: YES];
   [parser doValidityChecking: YES];
   PASS([parser parse] == YES, "plist containing string is valid")
+  testHopeful = NO;
 
   PASS_EQUAL([[[[[parser document] root] firstChild] firstChild] content],
     @"xxx", "root/plist/string is parsed")
